{% load static %}
<script src="{% static 'jQuery.js' %}"></script>
<script src="{% static 'script.js' %}"></script>
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Topaz</title>
        <link href='https://fonts.googleapis.com/css?family=Bree Serif' rel='stylesheet'>
        <link href='https://fonts.googleapis.com/css?family=Source Sans Pro' rel='stylesheet'>
        <link rel="stylesheet" href="{% static 'styles.css' %}">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script>

            function analyzeText(event){
                var searchIDNum = getIDNum(event.target);
                var textID = "textField:".concat(searchIDNum);
                var text = document.getElementById(textID).value;
                var city = document.getElementById('city').value;

                $.ajax({
                    type: "POST",
                    url: '{{ "my-ajax-test/" }}',
                    data: { csrfmiddlewaretoken: '{{ csrf_token }}', text: text, city: city },  
                    success: function callback(response){
                        destroyPreviousResults();
                        if (response == "[]") {
                            noResults(text, city);
                        }
                        else {
                            showResults(response, searchIDNum);
                        }
                    },
                    error: function callback(response) {
                        destroyPreviousResults();
                        noResults(text, city);
                    }
                });
            }
        </script>
    </head>
    <body onload="load()">
        <header class='main'>
            <div class="angleBracketHolder">
                <h1>></h1>
            </div>
            <div class="content">
                <h1>Topaz</h1>
                <h2>Tourism Made Easy</h2>
            </div>
        </header>
        <section class='controls'>
            <div class='angleBracketHolder'>
                <h3>></h3>
                <input type='text' class='spacer field'>
                <h3 class='disabledAtStart'>></h3>
                <div class='spacer'>
                    <input type="date" class = 'field'>
                    <br>
                    <span>from</span>
                    <br>
                    <input type="time" class='field'>
                    <br>
                </div>
                <h3 class='disabledAtStart'>></h3>
            </div>
            <div class='content'>
                <form>
                    <h3>Where are you visiting?</h3>
                    <input type="text" id="city" class='field' placeholder="New York, NY" onblur='enableForm()'>
                    <br>
                    <h3 class='disabledAtStart'>When will you be there?</h3>
                    <input type="date" id="startDate" class='field disabledAtStart' disabled>
                    <span class='disabledAtStart'>at</span>
                    <input type="time" id="startTime" class='field disabledAtStart' disabled>
                    <br>
                    <span class='disabledAtStart'>to</span>
                    <br>
                    <input type="date" id="endDate" class='field disabledAtStart' disabled>
                    <span class='disabledAtStart'>at</span>
                    <input type="time" id="endTime" class='field disabledAtStart' disabled>
                    <br>
                    <h3 class='disabledAtStart'>What would you like to do?</h3>
                    <ul id="activities"></ul>
                    <input id='addRowButton' type="button" value="+" onclick="addNewActivityLine()" class='buttonClass disabledAtStart' disabled>
                    <br>
                </form>
                <form action='results' method='GET'>
                <button id="resultsButton" type='submit' class='buttonClass' disabled>Plan My Day!</button>
            </div>
        </section>
        <section class='searchResults' id='searchResults'>
            <div id='searchResult:0'>
                <div class='leftSideDetails'>
                    <h2>Topaz with a loooooooooooooooooooooooong title</h2>
                    <img class='yelpStars' src="{% static 'resources\yelpStars\large_5@2x.png' %}" alt="">
                    <span class='totalReviews'>999999999 Reviews</span>
                    <br>
                    <span class='price'>$$$$</span>
                    <span class='bullet'>></span>
                    <span class='categories'>Travel Planner, Capstone Project</span>
                    <br>
                    <span class='address'>10900 Euclid Ave</span>
                    <br>
                    <span class='address'>Cleveland, OH 44106</span>
                </div>
                <div class='vl'></div>
                <div class='yelpImagery'>
                    <div class='frame'>
                        <img class='yelpPhoto' src="https://s3-media0.fl.yelpcdn.com/bphoto/guODR3a5GTtxVj5f5sVLlQ/o.jpg" alt="">
                        <div class='glass'>
                            <a href="https://www.yelp.com/biz/case-western-reserve-university-cleveland-7" target='_blank'>
                                <img class='yelpLogo' src="{% static 'resources\yelpLogo.png' %}" alt="Yelp logo">
                            </a>
                        </div>
                    </div>
                </div>
                <div class='selectUI'>
                    <div class='selectControls'>
                        <input type='button' value="+" class='buttonClass selectButton'>
                    </div>
                </div>
            </div>
            <div id='searchResult:1'>
                <div class='leftSideDetails'>
                    <h2>Topaz</h2>
                    <img class='yelpStars' src="{% static 'resources\yelpStars\large_5@2x.png' %}" alt="">
                    <span class='totalReviews'>999999999 Reviews</span>
                    <br>
                    <span class='price'>$$$$</span>
                    <span class='bullet'>></span>
                    <span class='categories'>Travel Planner, Capstone Project<span>
                    <br>
                    <span class='address'>10900 Euclid Ave</span>
                    <br>
                    <span class='address'>Cleveland, OH 44106</span>
                </div>
                <div class='vl'></div>
                <div class='yelpImagery'>
                    <div class='frame'>
                        <img class='yelpPhoto' src="https://s3-media0.fl.yelpcdn.com/bphoto/guODR3a5GTtxVj5f5sVLlQ/o.jpg" alt="">
                        <div class='glass'>
                            <a href="https://www.yelp.com/biz/case-western-reserve-university-cleveland-7" target='_blank'>
                                <img class='yelpLogo' src="{% static 'resources\yelpLogo.png' %}" alt="Yelp logo">
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </body>
</html>
